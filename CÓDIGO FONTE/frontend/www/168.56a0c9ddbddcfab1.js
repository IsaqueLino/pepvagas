"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[168],{168:(S,f,a)=>{a.r(f),a.d(f,{EmpresaRepresentantesPageModule:()=>j});var P=a(177),R=a(4341),i=a(1075),v=a(8986),u=a(467),e=a(4438),E=a(3656),C=a(858),x=a(4796),b=a(2078),M=a(833);const y=()=>["/home"];function k(r,l){if(1&r){const s=e.RV6();e.j41(0,"tr",10),e.bIt("click",function(){const n=e.eBV(s).$implicit,o=e.XpG();return e.Njj(o.onRowClick(n.idconta))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()}if(2&r){const s=l.$implicit,t=e.XpG();e.AVh("selected",s.idconta===t.selectedIdConta),e.R7$(2),e.JRh(s.nome),e.R7$(2),e.JRh(null==s.conta?null:s.conta.email)}}const F=[{path:"",component:(()=>{var r;class l{constructor(t,n,o,p,m,d){this.toastController=t,this.navigationController=n,this.empresaService=o,this.authService=p,this.alertController=m,this.representanteService=d,this.user={},this.userType="",this.isLogged=!1,this.listaRepresentantes=[],this.selectedIdConta=null,this.currentPage=1,this.itemsPerPage=10,null==this.authService.getJwt()&&this.navigationController.navigateRoot("login")}ngOnInit(){var t=this;return(0,u.A)(function*(){yield t.getUser()})()}ionViewWillEnter(){var t=this;return(0,u.A)(function*(){yield t.carregarRepresentantes()})()}carregarRepresentantes(){var t=this;return(0,u.A)(function*(){try{t.listaRepresentantes=yield t.empresaService.getRepresentantesEmpresaId(t.userId),t.listaRepresentantes=t.listaRepresentantes.filter(n=>null!==n.conta)}catch{}})()}onRowClick(t){this.selectedIdConta=t}get paginatedListaRepresentante(){const t=(this.currentPage-1)*this.itemsPerPage;return this.listaRepresentantes.slice(t,t+this.itemsPerPage)}nextPage(){this.currentPage*this.itemsPerPage<this.listaRepresentantes.length&&this.currentPage++}previousPage(){this.currentPage>1&&this.currentPage--}excluir(){var t=this;return(0,u.A)(function*(){if(null==t.selectedIdConta)return void t.exibirMensagem("Selecione um representante");const n=String(t.selectedIdConta);try{var o;const c=yield t.representanteService.desativarRepresentante(n),h=(null==c?void 0:c.message)||(null==c||null===(o=c.data)||void 0===o?void 0:o.message);if("Representante desativado com sucesso!"===h){var p;const g=yield t.authService.deleteAccount(n);var m;null!=g&&null!==(p=g.data)&&void 0!==p&&p.message?(t.exibirMensagem("Conta desativada com sucesso!"),yield t.carregarRepresentantes(),t.selectedIdConta=null):t.exibirMensagem((null==g||null===(m=g.data)||void 0===m?void 0:m.message)||"Erro ao desativar a conta.")}else t.exibirMensagem(h||"Erro ao desativar o representante.")}catch(c){var d;const h=(null==c||null===(d=c.response)||void 0===d||null===(d=d.data)||void 0===d?void 0:d.message)||"Erro ao desativar representante ou conta.";t.exibirMensagem(h)}})()}getUser(){var t=this;return(0,u.A)(function*(){t.userId=t.authService.getUser();const n=t.authService.getType();null==t.userId?t.isLogged=!1:(t.userType=null!=n?n:"","E"===t.userType&&(t.user=yield t.empresaService.getEmpresa(t.userId)),t.isLogged=!0)})()}cadastrarRepresentante(){this.navigationController.navigateForward("cadastro-representante")}exibirMensagem(t){var n=this;return(0,u.A)(function*(){(yield n.toastController.create({message:t,duration:3e3,position:"top"})).present()})()}confirmarExclusao(){var t=this;return(0,u.A)(function*(){null!=t.selectedIdConta?yield(yield t.alertController.create({header:"Confirma\xe7\xe3o",message:"Tem certeza de que deseja excluir o representante?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",handler:()=>{t.excluir()}}]})).present():t.exibirMensagem("Selecione um representante")})()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.rXU(i.K_),e.rXU(E.q9),e.rXU(C.z),e.rXU(x.u),e.rXU(i.hG),e.rXU(b.m))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-empresa-representantes"]],decls:36,vars:6,consts:[[3,"fullscreen"],[1,"content"],[1,"container"],[1,"title"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click","disabled"],["color","danger",1,"botao-cancelar",3,"click"],["size","6"],["id","open-modal","expand","block",1,"butao",3,"click"],["color","light","expand","block",3,"routerLink"],[3,"click"]],template:function(t,n){1&t&&(e.j41(0,"ion-content",0),e.nrm(1,"app-nav"),e.j41(2,"div",1)(3,"div",2)(4,"ion-card")(5,"ion-card-header")(6,"h1",3),e.EFF(7," Lista de Representantes "),e.k0s()(),e.j41(8,"ion-card-content")(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"table")(13,"thead")(14,"tr")(15,"th"),e.EFF(16,"Nome"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Email"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,k,5,4,"tr",4),e.k0s()()()(),e.j41(21,"ion-row")(22,"ion-col")(23,"ion-button",5),e.bIt("click",function(){return n.previousPage()}),e.EFF(24,"Anterior"),e.k0s(),e.j41(25,"ion-button",5),e.bIt("click",function(){return n.nextPage()}),e.EFF(26,"Pr\xf3ximo"),e.k0s(),e.j41(27,"ion-button",6),e.bIt("click",function(){return n.confirmarExclusao()}),e.EFF(28,"Excluir"),e.k0s()()()(),e.j41(29,"ion-row")(30,"ion-col",7)(31,"ion-button",8),e.bIt("click",function(){return n.cadastrarRepresentante()}),e.EFF(32," Cadastrar Representante "),e.k0s()(),e.j41(33,"ion-col",7)(34,"ion-button",9),e.EFF(35,"Voltar ao In\xedcio"),e.k0s()()()()()()()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(20),e.Y8G("ngForOf",n.paginatedListaRepresentante),e.R7$(3),e.Y8G("disabled",1===n.currentPage),e.R7$(2),e.Y8G("disabled",n.currentPage*n.itemsPerPage>=n.listaRepresentantes.length),e.R7$(9),e.Y8G("routerLink",e.lJ4(5,y)))},dependencies:[P.Sq,i.Jm,i.b_,i.I9,i.ME,i.hU,i.W9,i.lO,i.ln,i.N7,v.Wk,M.P],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}h1[_ngcontent-%COMP%]{text-align:center}ion-content[_ngcontent-%COMP%]{overflow-y:auto}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.teste[_ngcontent-%COMP%]{--padding-top: 18px;--background: var(--ion-color-pep);--padding-bottom: 18px}.container[_ngcontent-%COMP%]{padding:0 10px;display:flex;flex-direction:column;justify-content:center;width:80%;max-width:1000px}ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);border-radius:5px;margin-bottom:10px;border:1px #BBB8B8 solid;padding:2px}.title[_ngcontent-%COMP%]{font-size:28px;font-weight:500;margin:0}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}ion-img[_ngcontent-%COMP%]{max-width:150px}.header[_ngcontent-%COMP%]{--background: var(--ion-color-pep);color:#fff}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;text-align:left}th[_ngcontent-%COMP%]{background-color:#f8f8f8;font-weight:700}tr.selected[_ngcontent-%COMP%]{background-color:#d1e7dd}.butao[_ngcontent-%COMP%]{--background: var(--ion-color-pep)}ion-card[_ngcontent-%COMP%]{box-shadow:#00000059 0 5px 15px}"]}),l})()}];let I=(()=>{var r;class l{}return(r=l).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[v.iI.forChild(F),v.iI]}),l})();var O=a(5553);let j=(()=>{var r;class l{}return(r=l).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[P.MD,R.YN,i.bv,I,O.h]}),l})()}}]);