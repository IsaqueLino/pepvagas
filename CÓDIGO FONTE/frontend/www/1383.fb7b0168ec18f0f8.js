"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1383],{1383:(G,p,i)=>{i.r(p),i.d(p,{ListarContasPageModule:()=>T});var h=i(177),P=i(4341),c=i(1075),g=i(8986),u=i(467),e=i(4438),b=i(3656),y=i(4796),x=i(858),M=i(2078),L=i(3045),S=i(8516),E=i(6857),k=i(833);const F=["modal2"],R=()=>["/home"];function j(o,l){if(1&o){const s=e.RV6();e.j41(0,"tr",9),e.bIt("click",function(){const n=e.eBV(s).$implicit,a=e.XpG();return e.Njj(a.onRowClick(n.idConta))}),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()}if(2&o){const s=l.$implicit,t=e.XpG();e.AVh("selected",s.idConta===t.selectedIdConta),e.R7$(2),e.JRh(s.nome||"Sem Nome"),e.R7$(2),e.JRh(s.email),e.R7$(2),e.JRh(t.getTipoLabel(s.tipo))}}const O=[{path:"",component:(()=>{var o;class l{constructor(t,n,a,r,d,m,C,f,v){this.toastController=t,this.contaServico=n,this.alertController=a,this.navigationController=r,this.empresaServico=d,this.representanteServico=m,this.profissionalLiberalServico=C,this.membroServico=f,this.candidatoServico=v,this.listaConta=[],this.selectedIdConta=null,this.currentPage=1,this.itemsPerPage=10,this.message="",null==this.contaServico.getJwt()&&this.navigationController.navigateRoot("login")}ngOnInit(){this.carregarLista()}carregarLista(){var t=this;return(0,u.A)(function*(){try{const a=(yield t.contaServico.listAcount()).data.filter(r=>"A"!==r.tipo);t.listaConta=yield Promise.all(a.map(function(){var r=(0,u.A)(function*(d){const m=yield t.getNomeByTipo(d.tipo,d.idConta);return{idConta:d.idConta,nome:m,email:d.email,tipo:d.tipo}});return function(d){return r.apply(this,arguments)}}()))}catch(n){console.error("Erro ao carregar a lista de contas:",n),t.exibirMensagem("Erro ao carregar a lista de contas. Tente novamente.")}})()}getNomeByTipo(t,n){var a=this;return(0,u.A)(function*(){try{const r=String(n);switch(t){case"E":return(yield a.empresaServico.getEmpresa(r)).nomeEmpresa||"Sem Nome";case"R":return(yield a.representanteServico.getRepresentante(r)).nome||"Sem Nome";case"L":return(yield a.profissionalLiberalServico.getProfissionalLiberal(r)).nome||"Sem Nome";case"M":return(yield a.membroServico.getMembroEquipe(r)).nome||"Sem Nome";case"C":return(yield a.candidatoServico.getCandidato(r)).nome||"Sem Nome";default:return"Sem Nome"}}catch(r){return console.error(`Erro ao buscar nome para conta tipo ${t}:`,r),"Sem Nome"}})()}getTipoLabel(t){switch(t){case"E":return"Empresa";case"R":return"Representante";case"L":return"Prof. Liberal";case"M":return"Mem. Equipe";case"C":return"Candidato";default:return t}}get paginatedListaConta(){const t=(this.currentPage-1)*this.itemsPerPage;return this.listaConta.slice(t,t+this.itemsPerPage)}nextPage(){this.currentPage*this.itemsPerPage<this.listaConta.length&&this.currentPage++}previousPage(){this.currentPage>1&&this.currentPage--}onRowClick(t){this.selectedIdConta=t}excluir(){var t=this;return(0,u.A)(function*(){if(null==t.selectedIdConta)return void t.exibirMensagem("Selecione uma conta.");const n=String(t.selectedIdConta),a=t.listaConta.find(r=>r.idConta===t.selectedIdConta);try{switch(yield t.contaServico.deleteAccount(n),a.tipo){case"E":yield t.empresaServico.desativarEmpresa(n);break;case"R":yield t.representanteServico.desativarRepresentante(n);break;case"L":yield t.profissionalLiberalServico.desativarProfissional(n);break;case"M":yield t.membroServico.desativarMembro(n);break;case"C":yield t.candidatoServico.desativarCandidato(n)}yield t.carregarLista(),t.selectedIdConta=null,(yield t.toastController.create({message:"Conta exclu\xedda com sucesso!",duration:2e3,position:"bottom"})).present()}catch(r){console.error("Erro ao excluir conta e dados vinculados:",r),t.exibirMensagem("Erro ao excluir a conta. Tente novamente.")}})()}confirmarExclusao(){var t=this;return(0,u.A)(function*(){null!=t.selectedIdConta?yield(yield t.alertController.create({header:"Confirma\xe7\xe3o",message:"Tem certeza de que deseja excluir a conta?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",handler:()=>{t.excluir()}}]})).present():t.exibirMensagem("Selecione uma conta.")})()}exibirMensagem(t){var n=this;return(0,u.A)(function*(){(yield n.toastController.create({message:t,duration:3e3,position:"top"})).present()})()}cancelar(){var t=this;return(0,u.A)(function*(){t.modal2.dismiss(null,"cancel")})()}onWillDismissPassword(t){"confirm"===t.detail.role&&(this.message=`Hello, ${t.detail.data}!`)}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(c.K_),e.rXU(y.u),e.rXU(c.hG),e.rXU(b.q9),e.rXU(x.z),e.rXU(M.m),e.rXU(L.M),e.rXU(S.S),e.rXU(E.X))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-listar-contas"]],viewQuery:function(t,n){if(1&t&&e.GBs(F,7),2&t){let a;e.mGM(a=e.lsd())&&(n.modal2=a.first)}},decls:36,vars:6,consts:[[3,"fullscreen"],[1,"content"],[1,"container"],[1,"title"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click","disabled"],["size","6"],["color","danger","expand","block",1,"teste",3,"click"],["color","light","expand","block",1,"teste",3,"routerLink"],[3,"click"]],template:function(t,n){1&t&&(e.j41(0,"ion-content",0),e.nrm(1,"app-nav"),e.j41(2,"div",1)(3,"div",2)(4,"ion-card")(5,"ion-card-header")(6,"h1",3),e.EFF(7,"Listar Contas"),e.k0s()(),e.j41(8,"ion-card-content")(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"table")(13,"thead")(14,"tr")(15,"th"),e.EFF(16,"Nome"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Email"),e.k0s(),e.j41(19,"th"),e.EFF(20,"Tipo"),e.k0s()()(),e.j41(21,"tbody"),e.DNE(22,j,7,5,"tr",4),e.k0s()()()(),e.j41(23,"ion-row")(24,"ion-col")(25,"ion-button",5),e.bIt("click",function(){return n.previousPage()}),e.EFF(26,"Anterior"),e.k0s(),e.j41(27,"ion-button",5),e.bIt("click",function(){return n.nextPage()}),e.EFF(28,"Pr\xf3ximo"),e.k0s()()()()()(),e.j41(29,"ion-row")(30,"ion-col",6)(31,"ion-button",7),e.bIt("click",function(){return n.confirmarExclusao()}),e.EFF(32,"Excluir"),e.k0s()(),e.j41(33,"ion-col",6)(34,"ion-button",8),e.EFF(35,"Voltar"),e.k0s()()()()()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(22),e.Y8G("ngForOf",n.paginatedListaConta),e.R7$(3),e.Y8G("disabled",1===n.currentPage),e.R7$(2),e.Y8G("disabled",n.currentPage*n.itemsPerPage>=n.listaConta.length),e.R7$(7),e.Y8G("routerLink",e.lJ4(5,R)))},dependencies:[h.Sq,k.P,c.Jm,c.b_,c.I9,c.ME,c.hU,c.W9,c.lO,c.ln,c.N7,g.Wk],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}h1[_ngcontent-%COMP%]{text-align:center}ion-content[_ngcontent-%COMP%]{overflow-y:auto}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.teste[_ngcontent-%COMP%]{--padding-top: 18px;--background: var(--ion-color-pep);--padding-bottom: 18px}.container[_ngcontent-%COMP%]{padding:0 10px;display:flex;flex-direction:column;justify-content:center;width:80%;max-width:1000px}ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);border-radius:5px;margin-bottom:10px;border:1px #BBB8B8 solid;padding:2px}.title[_ngcontent-%COMP%]{font-size:28px;font-weight:500;margin:0}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}ion-img[_ngcontent-%COMP%]{max-width:150px}.header[_ngcontent-%COMP%]{--background: var(--ion-color-pep);color:#fff}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px;text-align:left}th[_ngcontent-%COMP%]{background-color:#f8f8f8;font-weight:700}tr.selected[_ngcontent-%COMP%]{background-color:#d1e7dd}ion-card[_ngcontent-%COMP%]{box-shadow:#00000059 0 5px 15px}"]}),l})()}];let I=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.iI.forChild(O),g.iI]}),l})();var N=i(5553);let T=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[h.MD,N.h,P.YN,c.bv,I]}),l})()}}]);