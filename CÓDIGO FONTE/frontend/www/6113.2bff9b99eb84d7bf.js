"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6113],{6113:(L,h,c)=>{c.r(h),c.d(h,{PerfilProfissionalLiberalPageModule:()=>D});var P=c(177),m=c(4341),r=c(1075),b=c(1208),v=c(8986),f=c(467),e=c(4438),C=c(3656),k=c(4796),j=c(7700),M=c(3045),S=c(833);const T=["modal1"],y=["modal2"];function E(t,d){if(1&t&&(e.j41(0,"ion-select-option",39),e.EFF(1),e.k0s()),2&t){const l=d.$implicit;e.Y8G("value",l.id),e.R7$(),e.JRh(l.nome)}}function F(t,d){if(1&t){const l=e.RV6();e.j41(0,"ion-toolbar")(1,"ion-buttons",22),e.bIt("click",function(){e.eBV(l);const i=e.XpG();return e.Njj(i.fechar())}),e.j41(2,"ion-button"),e.EFF(3,"Voltar"),e.k0s()(),e.j41(4,"ion-buttons",23)(5,"ion-button",24),e.bIt("click",function(){e.eBV(l);const i=e.XpG();return e.Njj(i.onSubmit())}),e.EFF(6,"Enviar"),e.k0s()()(),e.j41(7,"ion-content",25),e.nrm(8,"br"),e.j41(9,"h2",7),e.EFF(10,"Alterando as informa\xe7\xf5es do profissional liberal"),e.k0s(),e.j41(11,"form",26)(12,"ion-item"),e.nrm(13,"ion-input",27),e.k0s(),e.j41(14,"ion-item"),e.nrm(15,"ion-input",28),e.k0s(),e.j41(16,"ion-item"),e.nrm(17,"ion-input",29),e.k0s(),e.j41(18,"ion-item"),e.nrm(19,"ion-input",30),e.k0s(),e.j41(20,"ion-item",31)(21,"ion-select",32),e.bIt("ionChange",function(i){e.eBV(l);const a=e.XpG();return e.Njj(a.onTipoChange(i))}),e.DNE(22,E,2,2,"ion-select-option",33),e.j41(23,"ion-select-option",34),e.EFF(24,"Cadastar novo tipo de servi\xe7o"),e.k0s()()(),e.j41(25,"ion-item"),e.nrm(26,"ion-input",35),e.k0s(),e.j41(27,"ion-row")(28,"ion-col",36)(29,"ion-button",37),e.bIt("click",function(){e.eBV(l);const i=e.sdS(32);return e.Njj(i.click())}),e.EFF(30),e.k0s(),e.j41(31,"input",38,2),e.bIt("change",function(i){e.eBV(l);const a=e.XpG();return e.Njj(a.onFileSelected(i))}),e.k0s()()()()()}if(2&t){const l=e.XpG();e.R7$(5),e.Y8G("strong",!0),e.R7$(6),e.Y8G("formGroup",l.obrigatorio),e.R7$(6),e.Y8G("maskito",l.phoneMask)("maskitoElement",l.maskPredicate),e.R7$(5),e.Y8G("ngForOf",l.opcoes),e.R7$(8),e.SpI(" ",l.selectedFile?"Imagem de divulga\xe7\xe3o Selecionado: "+l.selectedFile.name:"Selecionar imagem de divulga\xe7\xe3o"," ")}}function I(t,d){if(1&t){const l=e.RV6();e.j41(0,"ion-toolbar")(1,"ion-buttons",40)(2,"ion-button",41),e.bIt("click",function(){e.eBV(l);const i=e.XpG();return e.Njj(i.cancelPassword())}),e.EFF(3,"Voltar"),e.k0s()(),e.j41(4,"ion-buttons",23)(5,"ion-button",24),e.bIt("click",function(){e.eBV(l);const i=e.XpG();return e.Njj(i.confirmPassword())}),e.EFF(6,"Enviar"),e.k0s()()(),e.j41(7,"ion-content",25),e.nrm(8,"br"),e.j41(9,"h2",7),e.EFF(10,"Alterar Senha"),e.k0s(),e.j41(11,"form",26)(12,"ion-item")(13,"ion-input",42),e.nrm(14,"ion-input-password-toggle",43),e.k0s()(),e.j41(15,"ion-item")(16,"ion-input",44),e.nrm(17,"ion-input-password-toggle",43),e.k0s()(),e.j41(18,"ion-item")(19,"ion-input",45),e.nrm(20,"ion-input-password-toggle",43),e.k0s()()()()}if(2&t){const l=e.XpG();e.R7$(5),e.Y8G("strong",!0),e.R7$(6),e.Y8G("formGroup",l.senha)}}const x=[{path:"",component:(()=>{var t;class d{constructor(o,i,a,s,n,u,g){this.formBuilder=o,this.alertController=i,this.toastController=a,this.authService=s,this.navController=n,this.tipoService=u,this.profissionalService=g,this.isDarkTheme=!1,this.isLogged=!1,this.selectedFile=null,this.opcoes=[],this.tipoDeServico={},this.conta={},this.profissional={},this.proficionalAlterado={},this.maskPredicate=function(){var p=(0,f.A)(function*(_){return _.getInputElement()});return function(_){return p.apply(this,arguments)}}(),this.phoneMask={mask:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]},this.message="This modal example uses triggers to automatically open a modal when the button is clicked.",this.actionSheetButtons=[{text:"Prosseguir",role:"destructive",handler:()=>{this.deactivateAccount(this.conta.idConta)}},{text:"Cancelar",role:"cancel",data:{action:"cancel"}}],null==this.authService.getJwt()&&this.navController.navigateRoot("login"),this.obrigatorio=this.formBuilder.group({nome:[null],nomeSocial:[null],descricao:[null],telefone:[null],email:[null],tipo:[null],imagem:[null]}),this.senha=this.formBuilder.group({senhaAtaul:[null],senhaNova:[null],senhaConfirmada:[null]})}ngOnInit(){var o=this;return(0,f.A)(function*(){o.obterOpcoes(),o.checkTheme(),"true"===localStorage.getItem("mostrarToastAtualizacao")&&(localStorage.removeItem("mostrarToastAtualizacao"),o.presentToast("Profissional Liberal atualizado com sucess!o")),o.authService.getJwt()&&(o.isLogged=!0);try{o.conta=yield o.authService.getContaDetails()}catch(a){console.error("Erro ao obter detalhes da conta:",a)}try{o.profissional=yield o.profissionalService.buscarProfissional(o.conta.idConta)}catch{console.log("n\xe3o foi obtido")}o.conta.nome=o.profissional.nome,o.conta.nomeSocial=o.profissional.nomeSocial,o.conta.descricao=o.profissional.descricao,o.conta.telefone=o.formatTelefone(o.profissional.telefone),o.conta.email=o.profissional.email,o.tipoDeServico=yield o.profissionalService.buscarTipoPorProfissional(o.conta.idConta)})()}formatTipoProfissional(o){return Array.isArray(o)&&0!==o.length?o.map(a=>a.nome).join(", "):"Tipos de Servi\xe7os n\xe3o informados"}openEditModal(){this.obrigatorio.setValue({nome:this.conta.nome||null,nomeSocial:this.conta.nomeSocial||null,descricao:this.conta.descricao||null,telefone:this.conta.telefone||null,email:this.conta.email||null,tipo:this.tipoDeServico.map(o=>o.id)||null,imagem:null}),this.modal.present()}formatTelefone(o){return o&&11===o.length?o.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):o}onFileSelected(o){const a=o.target.files[0];null!=o.target.files[0]&&(null!=a&&a.size>8388608?this.presentToast("O tamanho do banner deve ter no maximo 8 MB "):this.selectedFile=a)}presentToast(o){var i=this;return(0,f.A)(function*(){(yield i.toastController.create({message:o,duration:2e3,position:"top"})).present()})()}obterOpcoes(){var o=this;return(0,f.A)(function*(){try{o.opcoes=yield o.tipoService.buscarTodosServicos(),o.opcoes.sort((i,a)=>i.nome.localeCompare(a.nome))}catch(i){console.error("Erro ao buscar as op\xe7\xf5es:",i),o.presentToast("Erro ao carregar as op\xe7\xf5es de servi\xe7os.")}})()}onWillDismiss(o){"confirm"===o.detail.role&&(this.message=`Hello, ${o.detail.data}!`)}onWillDismissPassword(o){"confirm"===o.detail.role&&(this.message=`Hello, ${o.detail.data}!`)}exibirMensagem(o){var i=this;return(0,f.A)(function*(){(yield i.toastController.create({message:o,duration:3e3,position:"top"})).present()})()}confirmPassword(){this.updatePassword()}cancelPassword(){this.modal2.dismiss(null,"cancel")}updatePassword(){var o=this;return(0,f.A)(function*(){try{o.senha.value.senhaNova.length<4?o.exibirMensagem("Nova senha deve ter no m\xednimo 4 caracteres."):o.senha.value.senhaNova!=o.senha.value.senhaConfirmada?o.exibirMensagem("A nova senha e sua confirma\xe7\xe3o n\xe3o coincidem."):200===(yield o.authService.updatePassword(o.conta.idConta,o.senha.value.senhaAtaul,o.senha.value.senhaNova,o.senha.value.senhaConfirmada)).status?(o.exibirMensagem("Senha atualizada com sucesso!"),o.modal2.dismiss(null,"confirm"),o.senha.value.senhaAtaul="",o.senha.value.senhaNova="",o.senha.value.senhaConfirmada=""):o.exibirMensagem("Senha Atual incorreta")}catch(i){console.error("Erro ao atualizar a senha:",i),o.exibirMensagem("Senha Atual incorreta")}})()}toggleTheme(){this.isDarkTheme=!this.isDarkTheme,this.handleTheme()}checkTheme(){"dark"==localStorage.getItem("theme")?document.body.setAttribute("color-scheme","dark"):document.body.setAttribute("color-scheme","light")}logout(){this.authService.logout(),this.navController.navigateForward("/login")}handleTheme(){this.isDarkTheme?(document.body.setAttribute("color-scheme","dark"),localStorage.setItem("theme","dark")):(document.body.setAttribute("color-scheme","light"),localStorage.setItem("theme","light"))}deactivateAccount(o){var i=this;return(0,f.A)(function*(){try{var a;const u=yield i.profissionalService.desativarProfissional(o),g=(null==u?void 0:u.message)||(null==u||null===(a=u.data)||void 0===a?void 0:a.message);if(g)if("Profissional desativado com sucesso!"===g){var s;const p=yield i.authService.deleteAccount(o);var n;null!=p&&null!==(s=p.data)&&void 0!==s&&s.message?(yield i.exibirMensagem("Conta desativada com sucesso!"),i.logout()):(console.error("Erro ao desativar a conta. Resposta da API de conta:",p),i.exibirMensagem((null==p||null===(n=p.data)||void 0===n?void 0:n.message)||"Erro ao desativar a conta. Tente novamente mais tarde."))}else console.error("Erro ao desativar :",g),i.exibirMensagem(g);else console.error("Resposta inv\xe1lida ou sem mensagem da API de representante."),i.exibirMensagem("Erro ao desativar . Tente novamente mais tarde.")}catch(u){console.error("Erro ao desativar :",u),i.exibirMensagem("Ocorreu um erro ao tentar desativar . Tente novamente.")}})()}fechar(){var o=this;return(0,f.A)(function*(){o.modal.dismiss(null,"cancel")})()}onTipoChange(o){var i=this;return(0,f.A)(function*(){const a=o.detail.value;a.includes("outro")&&(yield(yield i.alertController.create({header:"Outro Tipo de Servi\xe7o",inputs:[{name:"outroTipo",type:"text",placeholder:"Informe o outro tipo de servi\xe7o"}],buttons:[{text:"Cancelar",role:"cancel",handler:()=>{i.obrigatorio.patchValue({tipo:a.filter(n=>"outro"!==n)})}},{text:"OK",handler:n=>{n.outroTipo&&(i.tipoService.cadastrarTipo(n.outroTipo),i.opcoes.push({id:n.outroTipo,nome:n.outroTipo}),i.obrigatorio.patchValue({tipo:[...a.filter(g=>"outro"!==g),n.outroTipo]}))}}]})).present())})()}onSubmit(){var o=this;return(0,f.A)(function*(){try{const i={nome:o.obrigatorio.value.nome||o.profissional.nome,nomeSocial:o.obrigatorio.value.nomeSocial||o.profissional.nomeSocial,descricao:o.obrigatorio.value.descricao||o.profissional.descricao,telefone:o.obrigatorio.value.telefone?o.obrigatorio.value.telefone.replace(/[^\d]/g,""):o.profissional.telefone,email:o.obrigatorio.value.email||o.profissional.email,tipo:o.obrigatorio.value.tipo||o.tipoDeServico.map(n=>n.id)};yield o.profissionalService.atualizarProficional(o.conta.idConta,i.nome,i.nomeSocial,i.descricao,i.telefone,i.email),yield o.profissionalService.cadastrarTipo(o.conta.idConta,i.tipo),o.selectedFile&&(yield o.profissionalService.enviarImagem(o.conta.idConta,o.selectedFile)),yield o.carregarDadosAtualizados(),o.presentToast("Dados atualizados com sucesso!"),o.modal.dismiss(null,"confirm")}catch(i){console.error("Erro detalhado:",i),localStorage.setItem("mostrarToastAtualizacao","true"),window.location.reload()}})()}carregarDadosAtualizados(){var o=this;return(0,f.A)(function*(){o.profissional=yield o.profissionalService.buscarProfissional(o.conta.idConta),o.tipoDeServico=yield o.profissionalService.buscarTipoPorProfissional(o.conta.idConta),o.conta.nome=o.profissional.nome,o.conta.nomeSocial=o.profissional.nomeSocial,o.conta.descricao=o.profissional.descricao,o.conta.telefone=o.formatTelefone(o.profissional.telefone),o.conta.email=o.profissional.email})()}}return(t=d).\u0275fac=function(o){return new(o||t)(e.rXU(m.ok),e.rXU(r.hG),e.rXU(r.K_),e.rXU(k.u),e.rXU(C.q9),e.rXU(j.d),e.rXU(M.M))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-perfil-profissional-liberal"]],viewQuery:function(o,i){if(1&o&&(e.GBs(T,7),e.GBs(y,7)),2&o){let a;e.mGM(a=e.lsd())&&(i.modal=a.first),e.mGM(a=e.lsd())&&(i.modal2=a.first)}},decls:56,vars:11,consts:[["modal1",""],["modal2",""],["fileInput",""],[3,"fullscreen"],[1,"content"],[1,"container"],[1,"title"],[2,"text-align","center"],["label","Email","labelPlacement","floating","readonly","",3,"ngModelChange","ngModel"],["id","open-modal2","expand","block",1,"butao"],["size","6"],["name","nome","label","Nome","labelPlacement","floating","placeholder","Informe o nome","readonly","",3,"ngModelChange","ngModel"],["name","nomeSocial","label","Nome Social (opcional)","labelPlacement","floating","placeholder","Informe o nome social","readonly","",3,"ngModelChange","ngModel"],["name","telefone","label","Telefone","labelPlacement","floating","placeholder","Informe o telefone para contato","maxlength","15","type","tel","readonly","",3,"ngModelChange","ngModel","maskito","maskitoElement"],["name","email","label","Email","labelPlacement","floating","placeholder","Informe o email de contato","type","email","readonly","",3,"ngModelChange","ngModel"],["label","Tipo de servi\xe7o prestado","readonly","","labelPlacement","floating","placeholder","\xc1reas de interesse n\xe3o informadas",3,"value"],["name","descricao","label","Descri\xe7\xe3o","labelPlacement","floating","placeholder","Informe a Descri\xe7\xe3o","readonly","",3,"ngModelChange","ngModel"],["id","open-modal","expand","block",1,"butao",3,"click"],["color","danger","expand","block","id","open-action-sheet",1,"botao-cancelar"],["trigger","open-action-sheet","header","Tem certeza que deseja excluir sua conta?",3,"buttons"],["trigger","open-modal",3,"willDismiss"],["trigger","open-modal2",3,"willDismiss"],["slot","start",3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],[3,"formGroup"],["formControlName","nome","label","Nome","labelPlacement","floating","placeholder","Informe o nome"],["formControlName","nomeSocial","label","Nome Social (opcional)","labelPlacement","floating","placeholder","Informe o nome social"],["formControlName","telefone","label","Telefone","labelPlacement","floating","placeholder","Informe o telefone para contato","maxlength","15","type","tel",3,"maskito","maskitoElement"],["formControlName","email","label","Email","labelPlacement","floating","placeholder","Informe o email de contato","type","email"],[1,"form-item"],["formControlName","tipo","multiple","true","label","Tipo de servi\xe7o prestado","labelPlacement","floating",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","outro"],["formControlName","descricao","label","Descri\xe7\xe3o","labelPlacement","floating","placeholder","Descri\xe7\xe3o da atua\xe7\xe3o"],["size","12"],["expand","block",1,"teste",3,"click"],["type","file","formControlName","imagem",2,"display","none",3,"change"],[3,"value"],["slot","start"],[3,"click"],["formControlName","senhaAtaul","type","password","label","Senha atual","labelPlacement","floating"],["slot","end","color","success"],["formControlName","senhaNova","type","password","label","Senha nova","labelPlacement","floating"],["formControlName","senhaConfirmada","type","password","label","Confirmar senha nova","labelPlacement","floating"]],template:function(o,i){if(1&o){const a=e.RV6();e.j41(0,"ion-content",3),e.nrm(1,"app-nav"),e.j41(2,"div",4)(3,"div",5)(4,"ion-card")(5,"ion-card-header")(6,"h1",6),e.EFF(7,"Perfil do Profissional Liberal"),e.k0s()(),e.j41(8,"ion-card-content")(9,"h1",7),e.EFF(10,"Informa\xe7\xf5es da Conta"),e.k0s(),e.j41(11,"ion-item")(12,"ion-input",8),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.email,n)||(i.conta.email=n),e.Njj(n)}),e.k0s()(),e.j41(13,"ion-row")(14,"ion-col")(15,"ion-button",9),e.EFF(16,"Alterar Senha"),e.k0s()()()(),e.j41(17,"ion-card-content")(18,"h1",7),e.EFF(19,"Informa\xe7\xf5es do profissional "),e.k0s(),e.j41(20,"form")(21,"ion-row")(22,"ion-col",10)(23,"ion-item")(24,"ion-input",11),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.nome,n)||(i.conta.nome=n),e.Njj(n)}),e.k0s()()(),e.j41(25,"ion-col",10)(26,"ion-item")(27,"ion-input",12),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.nomeSocial,n)||(i.conta.nomeSocial=n),e.Njj(n)}),e.k0s()()()(),e.j41(28,"ion-row")(29,"ion-col",10)(30,"ion-item")(31,"ion-input",13),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.telefone,n)||(i.conta.telefone=n),e.Njj(n)}),e.k0s()()(),e.j41(32,"ion-col",10)(33,"ion-item")(34,"ion-input",14),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.email,n)||(i.conta.email=n),e.Njj(n)}),e.k0s()()()(),e.j41(35,"ion-row")(36,"ion-col",10)(37,"ion-item"),e.nrm(38,"ion-input",15),e.k0s()(),e.j41(39,"ion-col",10)(40,"ion-item")(41,"ion-input",16),e.mxI("ngModelChange",function(n){return e.eBV(a),e.DH7(i.conta.descricao,n)||(i.conta.descricao=n),e.Njj(n)}),e.k0s()()()()()(),e.j41(42,"ion-row")(43,"ion-col",10)(44,"ion-button",17),e.bIt("click",function(){return e.eBV(a),e.Njj(i.openEditModal())}),e.EFF(45," Alterar Perfil "),e.k0s()(),e.j41(46,"ion-col",10)(47,"ion-button",18),e.nrm(48,"ion-action-sheet",19),e.EFF(49," Excluir conta "),e.k0s()()()()()(),e.j41(50,"ion-modal",20,0),e.bIt("willDismiss",function(n){return e.eBV(a),e.Njj(i.onWillDismiss(n))}),e.DNE(52,F,33,6,"ng-template"),e.k0s(),e.j41(53,"ion-modal",21,1),e.bIt("willDismiss",function(n){return e.eBV(a),e.Njj(i.onWillDismissPassword(n))}),e.DNE(55,I,21,2,"ng-template"),e.k0s()()}2&o&&(e.Y8G("fullscreen",!0),e.R7$(12),e.R50("ngModel",i.conta.email),e.R7$(12),e.R50("ngModel",i.conta.nome),e.R7$(3),e.R50("ngModel",i.conta.nomeSocial),e.R7$(4),e.R50("ngModel",i.conta.telefone),e.Y8G("maskito",i.phoneMask)("maskitoElement",i.maskPredicate),e.R7$(3),e.R50("ngModel",i.conta.email),e.R7$(4),e.Y8G("value",i.formatTipoProfissional(i.tipoDeServico)),e.R7$(3),e.R50("ngModel",i.conta.descricao),e.R7$(7),e.Y8G("buttons",i.actionSheetButtons))},dependencies:[m.qT,m.me,m.BC,m.cb,m.tU,m.vS,m.cV,b.uj,r.wC,r.Jm,r.QW,r.b_,r.I9,r.ME,r.hU,r.W9,r.$w,r.Wv,r.uz,r.ln,r.Nm,r.Ip,r.ai,r.Sb,r.Je,r.Gw,P.Sq,S.P,m.j4,m.JD],styles:["ion-title[_ngcontent-%COMP%]{text-align:center}h1[_ngcontent-%COMP%]{text-align:center}ion-content[_ngcontent-%COMP%]{overflow-y:auto}.profile-img[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;height:100px;align-items:center;margin-bottom:20px}.profile-img[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{box-shadow:#00000059 0 5px 15px;height:100px;width:100px;margin-left:-10px;padding:-10px}.user-img[_ngcontent-%COMP%]{width:25px;margin-left:15px}.butao[_ngcontent-%COMP%]{--background: var(--ion-color-pep)}.teste[_ngcontent-%COMP%]{--padding-top: 18px;--background: var(--ion-color-pep);--padding-bottom: 18px}.content[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;align-items:center;height:auto}.container[_ngcontent-%COMP%]{padding:0 10px;width:80%;max-width:1000px}ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);border-radius:5px;margin-bottom:10px;border:1px #BBB8B8 solid;padding:2px}.title[_ngcontent-%COMP%]{font-size:28px;font-weight:500;margin:0}ion-img[_ngcontent-%COMP%]{max-width:150px}.header[_ngcontent-%COMP%]{--background: var(--ion-color-pep);color:#fff}"]}),d})()}];let N=(()=>{var t;class d{}return(t=d).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[v.iI.forChild(x),v.iI]}),d})();var A=c(5553);let D=(()=>{var t;class d{}return(t=d).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[[m.YN,b.rt,r.bv.forRoot({})],P.MD,A.h,m.YN,r.bv,m.X1,N]}),d})()}}]);