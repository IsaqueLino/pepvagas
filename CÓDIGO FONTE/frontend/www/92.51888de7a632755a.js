"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[92],{92:(I,f,l)=>{l.r(f),l.d(f,{RepresentantePerfilPageModule:()=>F});var P=l(177),p=l(4341),s=l(1075),v=l(8986),g=l(467),e=l(4438),_=l(3656),b=l(4796),M=l(2078),R=l(5619),S=l(833);const j=["modal7"],C=["modal8"];function x(o,c){if(1&o){const r=e.RV6();e.j41(0,"ion-toolbar")(1,"ion-buttons",16)(2,"ion-button",17),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.cancel())}),e.EFF(3,"Voltar"),e.k0s()(),e.j41(4,"ion-title"),e.EFF(5,"Alterar Informa\xe7\xf5es"),e.k0s(),e.j41(6,"ion-buttons",18)(7,"ion-button",19),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.alterarRepresentante())}),e.EFF(8,"Enviar"),e.k0s()()(),e.j41(9,"ion-content",20),e.nrm(10,"br"),e.j41(11,"h2",5),e.EFF(12,"Informa\xe7\xf5es Gerais"),e.k0s(),e.j41(13,"ion-item")(14,"ion-input",21),e.mxI("ngModelChange",function(t){e.eBV(r);const a=e.XpG();return e.DH7(a.representanteAlterado.nome,t)||(a.representanteAlterado.nome=t),e.Njj(t)}),e.k0s()()()}if(2&o){const r=e.XpG();e.R7$(7),e.Y8G("strong",!0),e.R7$(7),e.R50("ngModel",r.representanteAlterado.nome)}}function E(o,c){if(1&o){const r=e.RV6();e.j41(0,"ion-toolbar")(1,"ion-buttons",16)(2,"ion-button",17),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.cancelPassword())}),e.EFF(3,"Voltar"),e.k0s()(),e.j41(4,"ion-title"),e.EFF(5,"Alterar Informa\xe7\xf5es"),e.k0s(),e.j41(6,"ion-buttons",18)(7,"ion-button",19),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.confirmPassword())}),e.EFF(8,"Enviar"),e.k0s()()(),e.j41(9,"ion-content",20),e.nrm(10,"br"),e.j41(11,"h2",5),e.EFF(12,"Alterar Senha"),e.k0s(),e.j41(13,"ion-item")(14,"ion-input",22),e.mxI("ngModelChange",function(t){e.eBV(r);const a=e.XpG();return e.DH7(a.novaSenha.senhaAtual,t)||(a.novaSenha.senhaAtual=t),e.Njj(t)}),e.nrm(15,"ion-input-password-toggle",23),e.k0s()(),e.j41(16,"ion-item")(17,"ion-input",24),e.mxI("ngModelChange",function(t){e.eBV(r);const a=e.XpG();return e.DH7(a.novaSenha.novaSenha,t)||(a.novaSenha.novaSenha=t),e.Njj(t)}),e.nrm(18,"ion-input-password-toggle",23),e.k0s()(),e.j41(19,"ion-item")(20,"ion-input",25),e.mxI("ngModelChange",function(t){e.eBV(r);const a=e.XpG();return e.DH7(a.novaSenha.confirmarSenha,t)||(a.novaSenha.confirmarSenha=t),e.Njj(t)}),e.nrm(21,"ion-input-password-toggle",23),e.k0s()()()}if(2&o){const r=e.XpG();e.R7$(7),e.Y8G("strong",!0),e.R7$(7),e.R50("ngModel",r.novaSenha.senhaAtual),e.R7$(3),e.R50("ngModel",r.novaSenha.novaSenha),e.R7$(3),e.R50("ngModel",r.novaSenha.confirmarSenha)}}const y=[{path:"",component:(()=>{var o;class c{constructor(n,t,a,m,i){this.toastController=n,this.authService=t,this.navController=a,this.representanteService=m,this.adminService=i,this.user={},this.userType="",this.isLogged=!1,this.representante={},this.representanteAlterado={},this.conta={},this.novaSenha={senhaAtual:"",novaSenha:"",confirmarSenha:""},this.nomeEmpresa="",this.message="This modal example uses triggers to automatically open a modal when the button is clicked.",this.actionSheetButtons=[{text:"Prosseguir",role:"destructive",handler:()=>{this.deactivateAccount(this.conta.idConta)}},{text:"Cancelar",role:"cancel",data:{action:"cancel"}}],null==this.authService.getJwt()&&this.navController.navigateRoot("login")}ngOnInit(){var n=this;return(0,g.A)(function*(){n.getUser(),n.conta=yield n.authService.getContaDetails(),n.representante=yield n.representanteService.getRepresentante(n.userId),n.nomeEmpresa=n.representante.idEmpresa.nomeEmpresa,n.representanteAlterado=Object.assign({},n.representante)})()}cancel(){this.representanteAlterado=Object.assign({},this.representante),this.modal7.dismiss(null,"cancel")}onWillDismissPassword(n){"confirm"===n.detail.role&&(this.message=`Hello, ${n.detail.data}!`)}cancelPassword(){this.modal8.dismiss(null,"cancel"),this.novaSenha.senhaAtual="",this.novaSenha.novaSenha="",this.novaSenha.confirmarSenha=""}confirmPassword(){this.updatePassword()}onWillDismiss(n){"confirm"===n.detail.role&&(this.message=`Hello, ${n.detail.data}!`)}exibirMensagem(n){var t=this;return(0,g.A)(function*(){(yield t.toastController.create({message:n,duration:3e3,position:"top"})).present()})()}logout(){this.authService.logout(),this.navController.navigateForward("login")}getUser(){var n=this;return(0,g.A)(function*(){n.userId=n.authService.getUser();const t=n.authService.getType();if(null==n.userId)n.isLogged=!1;else{switch(n.userType=null!=t?t:"",t){case"A":n.user=yield n.adminService.getAdministrador(n.userId);break;case"C":case"E":case"M":case"L":break;case"R":n.user=yield n.representanteService.getRepresentante(n.userId)}n.isLogged=!0}})()}updatePassword(){var n=this;return(0,g.A)(function*(){try{n.novaSenha.novaSenha.length<4?n.exibirMensagem("Nova senha deve ter no m\xednimo 4 caracteres."):n.novaSenha.novaSenha!=n.novaSenha.confirmarSenha?n.exibirMensagem("A nova senha e sua confirma\xe7\xe3o n\xe3o coincidem."):200===(yield n.authService.updatePassword(n.conta.idConta,n.novaSenha.senhaAtual,n.novaSenha.novaSenha,n.novaSenha.confirmarSenha)).status?(n.exibirMensagem("Senha atualizada com sucesso!"),n.modal8.dismiss(null,"confirm"),n.novaSenha.senhaAtual="",n.novaSenha.novaSenha="",n.novaSenha.confirmarSenha=""):n.exibirMensagem("Senha Atual incorreta")}catch(t){console.error("Erro ao atualizar a senha:",t),n.exibirMensagem("Senha Atual incorreta")}})()}deactivateAccount(n){var t=this;return(0,g.A)(function*(){try{var a;const d=yield t.representanteService.desativarRepresentante(n),h=(null==d?void 0:d.message)||(null==d||null===(a=d.data)||void 0===a?void 0:a.message);if(h)if("Representante desativado com sucesso!"===h){var m;const u=yield t.authService.deleteAccount(n);var i;null!=u&&null!==(m=u.data)&&void 0!==m&&m.message?(yield t.exibirMensagem("Conta desativada com sucesso!"),t.logout()):(console.error("Erro ao desativar a conta. Resposta da API de conta:",u),t.exibirMensagem((null==u||null===(i=u.data)||void 0===i?void 0:i.message)||"Erro ao desativar a conta. Tente novamente mais tarde."))}else console.error("Erro ao desativar o representante:",h),t.exibirMensagem(h);else console.error("Resposta inv\xe1lida ou sem mensagem da API de representante."),t.exibirMensagem("Erro ao desativar o representante. Tente novamente mais tarde.")}catch(d){console.error("Erro ao desativar representante ou conta:",d),t.exibirMensagem("Ocorreu um erro ao tentar desativar o representante ou a conta. Tente novamente.")}})()}alterarRepresentante(){var n=this;return(0,g.A)(function*(){if(0==n.representanteAlterado.nome.length)n.exibirMensagem("Informe o novo nome para o representante");else try{200==(yield n.representanteService.alterarRepresentante(n.userId,n.representanteAlterado.nome,n.representanteAlterado.idEmpresa.idconta)).status?(n.modal7.dismiss(n.representanteAlterado.nome,"confirm"),n.ngOnInit(),n.exibirMensagem("Representante alterado com sucesso!")):n.exibirMensagem("Erro interno no servidor")}catch(t){console.error(t)}})()}}return(o=c).\u0275fac=function(n){return new(n||o)(e.rXU(s.K_),e.rXU(b.u),e.rXU(_.q9),e.rXU(M.m),e.rXU(R.r))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-representante-perfil"]],viewQuery:function(n,t){if(1&n&&(e.GBs(j,7),e.GBs(C,7)),2&n){let a;e.mGM(a=e.lsd())&&(t.modal7=a.first),e.mGM(a=e.lsd())&&(t.modal8=a.first)}},decls:41,vars:4,consts:[["modal7",""],["modal8",""],["id","main-content"],[1,"content"],[1,"container"],[2,"text-align","center"],["label","Email","labelPlacement","floating","readonly","",3,"ngModelChange","ngModel"],["id","open-modal8","expand","block",1,"butao"],["readonly","","label","Nome","labelPlacement","floating","placeholder","Informe o nome do Representante","maxlength","60",3,"ngModelChange","ngModel"],["readonly","","label","Representante da Empresa:","labelPlacement","floating","placeholder","Nome da Empresa","maxlength","60",3,"ngModelChange","ngModel"],["size","6"],["id","open-modal7","expand","block",1,"butao"],["id","open-action-sheet","color","danger","expand","block",1,"botao-cancelar"],["trigger","open-action-sheet","header","Tem certeza que deseja excluir sua conta?",3,"buttons"],["trigger","open-modal7",3,"willDismiss"],["trigger","open-modal8",3,"willDismiss"],["slot","start"],[3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["label","Nome","labelPlacement","floating","placeholder","Informe o nome",3,"ngModelChange","ngModel"],["type","password","label","Senha atual","labelPlacement","floating",3,"ngModelChange","ngModel"],["slot","end","color","success"],["type","password","label","Senha nova","labelPlacement","floating",3,"ngModelChange","ngModel"],["type","password","label","Confirmar senha nova","labelPlacement","floating",3,"ngModelChange","ngModel"]],template:function(n,t){if(1&n){const a=e.RV6();e.j41(0,"ion-content",2),e.nrm(1,"app-nav"),e.j41(2,"div",3)(3,"div",4)(4,"ion-card")(5,"ion-card-content")(6,"h1",5),e.EFF(7,"Perfil do Representante"),e.k0s(),e.nrm(8,"br"),e.j41(9,"h1",5),e.EFF(10,"Informa\xe7\xf5es da Conta"),e.k0s(),e.nrm(11,"br"),e.j41(12,"ion-item")(13,"ion-input",6),e.mxI("ngModelChange",function(i){return e.eBV(a),e.DH7(t.conta.email,i)||(t.conta.email=i),e.Njj(i)}),e.k0s()(),e.j41(14,"ion-row")(15,"ion-col")(16,"ion-button",7),e.EFF(17,"Alterar Senha"),e.k0s()()(),e.nrm(18,"br"),e.j41(19,"h1",5),e.EFF(20,"Informa\xe7\xf5es Gerais"),e.k0s(),e.nrm(21,"br"),e.j41(22,"ion-item")(23,"ion-input",8),e.mxI("ngModelChange",function(i){return e.eBV(a),e.DH7(t.representante.nome,i)||(t.representante.nome=i),e.Njj(i)}),e.k0s()(),e.j41(24,"ion-item")(25,"ion-input",9),e.mxI("ngModelChange",function(i){return e.eBV(a),e.DH7(t.nomeEmpresa,i)||(t.nomeEmpresa=i),e.Njj(i)}),e.k0s()(),e.nrm(26,"br"),e.j41(27,"ion-row")(28,"ion-col",10)(29,"ion-button",11),e.EFF(30," Alterar Informa\xe7\xf5es "),e.k0s()(),e.j41(31,"ion-col",10)(32,"ion-button",12),e.EFF(33," Excluir Conta "),e.k0s(),e.nrm(34,"ion-action-sheet",13),e.k0s()(),e.j41(35,"ion-modal",14,0),e.bIt("willDismiss",function(i){return e.eBV(a),e.Njj(t.onWillDismiss(i))}),e.DNE(37,x,15,2,"ng-template"),e.k0s(),e.j41(38,"ion-modal",15,1),e.bIt("willDismiss",function(i){return e.eBV(a),e.Njj(t.onWillDismissPassword(i))}),e.DNE(40,E,22,4,"ng-template"),e.k0s()()()()()()}2&n&&(e.R7$(13),e.R50("ngModel",t.conta.email),e.R7$(10),e.R50("ngModel",t.representante.nome),e.R7$(2),e.R50("ngModel",t.nomeEmpresa),e.R7$(9),e.Y8G("buttons",t.actionSheetButtons))},dependencies:[p.BC,p.tU,p.vS,s.wC,s.Jm,s.QW,s.b_,s.I9,s.hU,s.W9,s.$w,s.Wv,s.uz,s.ln,s.BC,s.ai,s.Sb,s.Gw,S.P],styles:[".butao[_ngcontent-%COMP%]{--background: var(--ion-color-pep)}.header[_ngcontent-%COMP%]{--background: var(--ion-color-pep);color:#fff}.logo-img[_ngcontent-%COMP%]{max-width:150px}.menu-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}ion-content[_ngcontent-%COMP%]{overflow-y:auto}.container[_ngcontent-%COMP%]{padding:0 10px;display:flex;flex-direction:column;justify-content:center;width:80%;max-width:1000px}.content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}ion-item[_ngcontent-%COMP%]{--background: var(--ion-item-background);border-radius:5px;margin-bottom:10px;border:1px #BBB8B8 solid;padding:2px}ion-card[_ngcontent-%COMP%]{box-shadow:#00000059 0 5px 15px}"]}),c})()}];let k=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[v.iI.forChild(y),v.iI]}),c})();var A=l(5553);let F=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[P.MD,p.YN,s.bv,k,A.h]}),c})()}}]);